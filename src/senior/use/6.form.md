---
lang: zh-CN
sidebarDepth: 2
meta:
  - name: description
    content: 个人总结的vuepress学习技术文档-语法
  - name: keywords
    content: vuepress,最新技术文档,vuepress语法,markdown语法
---

# 六、具有数据校验功能的表单组件--Form

## Form 组件概览

表单类组件在项目中大量使用，比如输入框、单选、多选、下拉选择器等。在使用表单类组件时，也会常用到数据校验，如果每次都写校验程序来对每一个表单控件校验，会很低效，因此需要一个能够校验基础表单控件的组件，也就是本节要完成的 Form 组件。

Form 组件分为两个部分，一个是外层的`Form`表单域组件，一组表单控件只有一个 Form,而内部包含了多个`FormItem`组件，每一个表单控件都被一个 FormItem 包裹。

Form 要用到数据校验，并在对应的 FormItem 中给出校验失败的提示，校验我们用到一个开源库：`async-validator`,基本主流的组件库都是基于它做的校验。使用它很简单，只需按要求写好一个校验规则就好，比如：

```js
;[
  { required: true, message: "邮箱不能为空", trigger: "blur" },
  { type: "email", message: "邮箱格式不正确", trigger: "blur" },
]
```

这个代表校验的数据线判断是否为空，如果为空，则提示“邮箱不能为空”，触发校验的事件为失焦，如果第一条满足要求，再进行第二条的验证，判断是否为邮箱格式等等，还支持自定义校验规则。

## 接口设计

我们使用最新的 Vue CLI3 创建一个空白的项目，并使用`vue-router`插件，同时安装好`async-validator`库。

在`scr/components`下新建一个`form`文件夹，并初始化两个组件`form.vue`和`form-item.vue`，然后初始化项目，配置路由，创建一个页面能够被访问到。

编写一个 Vue.js 组件，最重要的是设计好它的接口，一个 Vue.js 组件的接口来自三个部分：props、slots、events。而 Form 和 FormItem 两个组件主要做数据校验，用不到 events。Form 的 slot 就是一系列的 FormItem，FormItem 的 solt 就是具体的表单控件，比如输入框。

在`Form`组件中，定义两个 props:

- model:表单控件绑定的数据对象，在校验或重置时会访问该数据对象下对应的表单数据，类型为 Object。
- rules:表单验证规则，即上面介绍的 async-validator 所使用的校验规则，类型为 Object。
  在`FormItem`组件中，也定义两个 props:
- label:单个表单组件的标签文本，类似原生`<label>`元素，类型为 String。
- prop:对应表单域 Form 组件 model 里的字段，用于校验或重置时访问表单组件绑定的数据，类型为 String。
